*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

/* ── Design tokens ────────────────────────────────────────────────────────── */
:root {
  --bg-deep:    #08121e;
  --bg-panel:   #0c1b30;
  --bg-inset:   #0a1525;
  --border:     #1a3050;
  --text:       #d0dff5;
  --text-muted: #5a7aaa;
  --accent:     #4a9aff;
  --gold:       #f5c842;
  --green:      #4caf50;
  --red:        #f44336;
  --orange:     #ffaa44;
  --pomo-red:   #cc4444;
  --radius-sm:  6px;
  --radius-md:  8px;
}

body {
  width: 360px;
  background: #08121e;
  color: #d0dff5;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  -webkit-font-smoothing: antialiased;
  overflow: hidden;
}

#app { position: relative; }

/* ── Tank ─────────────────────────────────────────────────────────────────── */
#tank-wrapper { position: relative; }

#tank {
  display: block;
  width: 360px; height: 260px;
  border-bottom: 2px solid #1a3a6a;
}

#settings-btn {
  position: absolute; top: 8px; right: 8px;
  width: 28px; height: 28px;
  background: rgba(0,0,0,0.35);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  color: rgba(255,255,255,0.55);
  font-size: 14px; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: background 0.2s, color 0.2s;
}
#settings-btn:hover { background: rgba(0,0,0,0.6); color: white; }

#debug-btn {
  position: absolute; top: 8px; left: 8px;
  width: 28px; height: 28px;
  background: rgba(0,0,0,0.35);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  color: rgba(255,255,255,0.55);
  font-size: 14px; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: background 0.2s, color 0.2s;
}
#debug-btn:hover { background: rgba(0,0,0,0.6); color: white; }
#debug-btn.active { background: rgba(80,40,0,0.7); color: #ffaa44; border-color: rgba(255,160,60,0.5); }

/* Arrange (rearrange decorations) button — bottom-right of tank */
#arrange-btn {
  position: absolute; bottom: 8px; right: 8px;
  width: 28px; height: 28px;
  background: rgba(0,0,0,0.35);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  color: rgba(255,255,255,0.45);
  font-size: 13px; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: background 0.2s, color 0.2s, border-color 0.2s;
}
#arrange-btn:hover { background: rgba(0,0,0,0.6); color: white; }
#arrange-btn.active {
  background: rgba(0,40,40,0.75);
  color: #00e8cc;
  border-color: rgba(0,220,190,0.55);
  box-shadow: 0 0 6px rgba(0,220,190,0.25);
}

/* ── Pomodoro burst overlay ───────────────────────────────────────────────── */
#pomo-burst {
  display: none;
  position: absolute;
  inset: 0;
  background: rgba(0,20,40,0.82);
  color: #f5c542;
  font-size: 15px;
  font-weight: bold;
  text-align: center;
  align-items: center;
  justify-content: center;
  border-radius: 4px;
  z-index: 10;
  padding: 16px;
}
#pomo-burst.show {
  display: flex;
  animation: burstAnim 2.8s ease forwards;
}
@keyframes burstAnim {
  0%   { opacity: 0; }
  15%  { opacity: 1; }
  75%  { opacity: 1; }
  100% { opacity: 0; }
}

#debug-panel {
  display: none;
  position: absolute; top: 262px; left: 0; right: 0;
  flex-direction: column; gap: 8px;
  padding: 12px 14px;
  background: rgba(10,21,32,0.88);
  border-top: 1px solid rgba(255,160,60,0.35);
  border-bottom: 1px solid rgba(255,160,60,0.35);
  color: #ffaa44;
  font: bold 11px monospace;
  z-index: 5;
  backdrop-filter: blur(2px);
}
#debug-panel.visible { display: flex; }
#debug-health-row, #debug-rate-row, #debug-accrual-row, #debug-grow-row { display: flex; justify-content: space-between; }
#debug-health-slider, #debug-rate-slider, #debug-accrual-slider, #debug-grow-slider { width: 100%; accent-color: #ffaa44; cursor: ew-resize; }

#debug-coin-btns { display: flex; gap: 4px; flex-wrap: wrap; }
.dbg-coin {
  flex: 1; padding: 3px 0;
  background: rgba(240,200,60,0.1);
  color: #f5c842;
  border: 1px solid rgba(240,200,60,0.3); border-radius: 4px;
  cursor: pointer; font: bold 10px monospace;
  transition: background 0.15s;
}
.dbg-coin:hover { background: rgba(240,200,60,0.25); }
#debug-pomo-btn {
  flex: 2; padding: 3px 6px;
  background: rgba(80,160,80,0.15);
  color: #88cc88; border: 1px solid rgba(80,160,80,0.35); border-radius: 4px;
  cursor: pointer; font: bold 10px monospace; white-space: nowrap;
  transition: background 0.15s;
}
#debug-pomo-btn:hover { background: rgba(80,160,80,0.3); }
#debug-fish-btn {
  flex: 2; padding: 3px 6px;
  background: rgba(60,130,200,0.15);
  color: #88bbee; border: 1px solid rgba(60,130,200,0.35); border-radius: 4px;
  cursor: pointer; font: bold 10px monospace; white-space: nowrap;
  transition: background 0.15s;
}
#debug-fish-btn:hover { background: rgba(60,130,200,0.3); }

/* ── Tab bar ──────────────────────────────────────────────────────────────── */
#tab-bar {
  display: flex;
  background: #091422;
  border-bottom: 1px solid #1a3050;
}
.tab-btn {
  flex: 1; padding: 7px 0;
  background: none; border: none; border-bottom: 2px solid transparent;
  color: #5a7aaa; font-size: 12px; font-weight: 600;
  text-transform: uppercase; letter-spacing: 0.5px;
  cursor: pointer; transition: color 0.15s, border-color 0.15s;
}
.tab-btn:hover { color: #a0c0e8; }
.tab-btn.active { color: #4a9aff; border-bottom-color: #4a9aff; }

/* ── Shop pane — scrollable ───────────────────────────────────────────────── */
#shop-pane {
  background: #0c1b30;
  display: flex;
  flex-direction: column;
}
#shop-pane-head {
  display: flex; align-items: center; gap: 6px;
  padding: 9px 14px 8px;
  border-bottom: 1px solid #1a3050;
  flex-shrink: 0;
}
#shop-pane-coins { font-size: 15px; font-weight: 700; color: #f5c842; }
#shop-pane-body {
  overflow-y: auto;
  max-height: 250px;
  padding: 7px 14px 12px;
  display: flex;
  flex-direction: column;
  gap: 6px;
  scrollbar-width: thin;
  scrollbar-color: #1a3050 #0a1525;
}
#shop-pane-body::-webkit-scrollbar { width: 5px; }
#shop-pane-body::-webkit-scrollbar-track { background: #0a1525; }
#shop-pane-body::-webkit-scrollbar-thumb { background: #1a3050; border-radius: 3px; }

#shop-pane-grid, #shop-dec-grid { display: flex; flex-direction: column; gap: 6px; }

.shop-section-label {
  font-size: 10px; font-weight: 700;
  text-transform: uppercase; letter-spacing: 1px;
  color: #3a6080; padding: 4px 0 2px;
}
.spc {
  display: flex; align-items: center; gap: 10px;
  padding: 5px 10px; border-radius: 8px;
  background: #0a1525; border: 1px solid #1a3050;
  transition: opacity 0.2s;
}
.spc.unaffordable { opacity: 0.4; }
.spc-canvas, .spc-dec-canvas { border-radius: 5px; flex-shrink: 0; }
.spc-info { flex: 1; }
.spc-name { display: block; font-size: 13px; font-weight: 600; }
.spc-desc { display: block; font-size: 11px; color: #4a6a8a; margin-top: 1px; }
.spc-btn, .spc-dec-btn {
  padding: 5px 11px;
  background: #2a1e00; color: #f5c842;
  border: 1px solid #7a5a10; border-radius: 6px;
  cursor: pointer; font-size: 12px; font-weight: 600;
  white-space: nowrap; transition: background 0.15s; flex-shrink: 0;
}
.spc-btn:hover:not(:disabled), .spc-dec-btn:hover:not(:disabled) { background: #3d2e00; }
.spc-btn:disabled, .spc-dec-btn:disabled { opacity: 0.4; cursor: not-allowed; }
.spc-hint { font-size: 11px; color: #4a6a8a; text-align: center; margin-top: 2px; }

/* ── Panel ────────────────────────────────────────────────────────────────── */
/* display:flex on #panel and #shop-pane beats the UA [hidden]{display:none},
   so we need to re-enforce it at higher specificity */
#panel[hidden], #shop-pane[hidden] { display: none !important; }

#panel {
  padding: 12px 16px;
  display: flex; flex-direction: column; gap: 8px;
  background: #0c1b30;
  position: relative;
}

#score-row { display: flex; align-items: center; gap: 8px; }

#score-bar-wrap {
  flex: 1; height: 7px;
  background: #162740; border-radius: 4px; overflow: hidden;
}
#score-bar {
  height: 100%; border-radius: 4px;
  width: 70%; background: #4caf50;
  transition: width 0.6s ease, background 0.6s ease;
}
#score-value { font-size: 15px; font-weight: 700; min-width: 30px; text-align: right; }

#status-row {
  display: flex; align-items: center; gap: 8px;
  background: #0a1525; border-radius: 8px;
  padding: 7px 12px; font-size: 13px; color: #8aa8cc;
}
#status-dot {
  width: 8px; height: 8px; border-radius: 50%;
  background: #555; flex-shrink: 0; transition: background 0.4s;
}
#status-dot.focused    { background: #4caf50; box-shadow: 0 0 6px #4caf5088; }
#status-dot.distracted { background: #f44336; box-shadow: 0 0 6px #f4433688; }
#status-dot.neutral    { background: #ff9800; }

#time-row {
  display: flex; align-items: center;
  background: #0a1525; border-radius: 8px; overflow: hidden;
}
.time-cell {
  flex: 1; display: flex; flex-direction: column;
  align-items: center; padding: 7px 12px;
}
.divider { width: 1px; height: 36px; background: #1a3050; }
.label {
  font-size: 11px; text-transform: uppercase;
  letter-spacing: 0.6px; color: #5a7aaa; margin-bottom: 3px;
}
.time-val { font-size: 16px; font-weight: 700; font-variant-numeric: tabular-nums; }
.time-cell.state-focused    { background: rgba(76,175,80,0.13);  border-radius: 8px; }
.time-cell.state-distracted { background: rgba(244,67,54,0.13); border-radius: 8px; }
.time-cell.state-focused    .label { color: #4caf50; }
.time-cell.state-distracted .label { color: #f44336; }
.time-cell.state-focused    .time-val { color: #6dd470; }
.time-cell.state-distracted .time-val { color: #f77; }

/* ── Food row ─────────────────────────────────────────────────────────────── */
#food-row {
  display: flex; align-items: center; gap: 8px;
  background: #0a1525; border-radius: 8px; padding: 6px 12px;
}
.food-icon { font-size: 14px; line-height: 1; flex-shrink: 0; }
.food-lbl  { white-space: nowrap; }
#food-bar-wrap {
  flex: 1; height: 6px;
  background: #162740; border-radius: 4px; overflow: hidden;
}
#food-bar {
  height: 100%; border-radius: 4px;
  width: 100%; background: #4caf50;
  transition: width 0.4s ease, background 0.4s ease;
}
#food-value { font-size: 12px; font-weight: 700; color: #a8c4e0; white-space: nowrap; }
.food-next  { font-size: 10px; color: #4a6a8a; white-space: nowrap; min-width: 42px; text-align: right; }

/* ── Pomodoro row ────────────────────────────────────────────────────────── */
#pomo-row {
  display: flex; align-items: center; gap: 8px;
  background: #0a1525; border-radius: 8px; padding: 7px 12px;
}
.pomo-icon { font-size: 14px; line-height: 1; }
#pomo-display {
  font-size: 18px; font-weight: 700; color: #cc4444;
  font-variant-numeric: tabular-nums; flex: 1; letter-spacing: 0.5px;
}
#pomo-row.active #pomo-display { color: #ff6666; text-shadow: 0 0 8px rgba(255,80,80,0.4); }
#pomo-btn {
  padding: 4px 14px;
  background: #2a0a0a; color: #cc4444;
  border: 1px solid #6a2020; border-radius: 6px;
  cursor: pointer; font-size: 12px; font-weight: 600;
  transition: background 0.2s; white-space: nowrap;
}
#pomo-btn:hover { background: #3d1010; color: #ff7777; }
#pomo-row.active #pomo-btn { background: #0d1a2a; color: #6688bb; border-color: #3a5080; }
#pomo-row.active #pomo-btn:hover { background: #152535; }

/* ── Coin row ─────────────────────────────────────────────────────────────── */
#coin-row {
  display: flex; align-items: center; gap: 6px;
  background: #0a1525; border-radius: 8px; padding: 7px 12px;
}
.coin-icon { font-size: 15px; line-height: 1; }
#coin-value { font-size: 16px; font-weight: 700; color: #f5c842; min-width: 32px; }
.coin-label {
  font-size: 11px; text-transform: uppercase;
  letter-spacing: 0.6px; color: #8a6a20; flex: 1;
}

/* ── Coin float animation ─────────────────────────────────────────────────── */
.coin-float {
  position: absolute;
  color: #f5c542;
  font-size: 12px;
  font-weight: bold;
  pointer-events: none;
  animation: coinFloat 1.2s ease-out forwards;
}
@keyframes coinFloat {
  0%   { opacity: 1; transform: translateY(0); }
  100% { opacity: 0; transform: translateY(-40px); }
}

#daily-btn {
  padding: 8px; width: 100%;
  background: #1e1400; color: #f5c842;
  border: 1px solid #5a4010; border-radius: 8px;
  cursor: pointer; font-size: 13px; font-weight: 600; letter-spacing: 0.3px;
  transition: background 0.2s, opacity 0.2s;
}
#daily-btn:hover:not(:disabled) { background: #2e1e00; }
#daily-btn:disabled { opacity: 0.45; cursor: not-allowed; }
