*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

/* ── Design tokens ────────────────────────────────────────────────────────── */
:root {
  --bg-deep:    #08121e;
  --bg-panel:   #0c1b30;
  --bg-inset:   #0a1525;
  --border:     #1a3050;
  --text:       #d0dff5;
  --text-muted: #5a7aaa;
  --text-dim:   #4a6a8a;
  --accent:     #4a9aff;
  --gold:       #f5c842;
  --green:      #4caf50;
  --red:        #f44336;
  --orange:     #ffaa44;
  --radius-sm:  6px;
  --radius-md:  8px;
}

/* ── Themes ───────────────────────────────────────────────────────────────── */
body[data-theme="midnight"] {
  --bg-deep:    #030508;
  --bg-panel:   #07090e;
  --bg-inset:   #050710;
  --border:     #10192a;
  --text:       #8a9fb8;
  --text-muted: #304050;
  --text-dim:   #243040;
  --accent:     #3068c0;
}
body[data-theme="coral"] {
  --bg-deep:    #180c12;
  --bg-panel:   #211018;
  --bg-inset:   #1a0e15;
  --border:     #3a1828;
  --text:       #f0c0d0;
  --text-muted: #885068;
  --text-dim:   #6a3a50;
  --accent:     #e07090;
}
body[data-theme="forest"] {
  --bg-deep:    #080f0a;
  --bg-panel:   #0c1810;
  --bg-inset:   #09130c;
  --border:     #162a1a;
  --text:       #b8e0c8;
  --text-muted: #48785a;
  --text-dim:   #345448;
  --accent:     #40a860;
}
body[data-theme="classic"] {
  --bg-deep:    #0a1420;
  --bg-panel:   #131d2c;
  --bg-inset:   #0e1825;
  --border:     #1e3048;
  --text:       #b8cce0;
  --text-muted: #485f78;
  --text-dim:   #364858;
  --accent:     #3a78c0;
}

body {
  width: 360px;
  background: var(--bg-deep);
  color: var(--text);
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  -webkit-font-smoothing: antialiased;
  overflow: hidden;
}

#app { position: relative; }

/* ── Tank ─────────────────────────────────────────────────────────────────── */
#tank-wrapper { position: relative; }

#tank {
  display: block;
  width: 360px; height: 260px;
  border-bottom: 2px solid #1a3a6a;
}

#settings-btn {
  position: absolute; top: 8px; right: 8px;
  width: 28px; height: 28px;
  background: rgba(0,0,0,0.35);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  color: rgba(255,255,255,0.55);
  font-size: 14px; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: background 0.2s, color 0.2s;
}
#settings-btn:hover { background: rgba(0,0,0,0.6); color: white; }

#debug-btn {
  position: absolute; top: 8px; left: 8px;
  width: 28px; height: 28px;
  background: rgba(0,0,0,0.35);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  color: rgba(255,255,255,0.55);
  font-size: 14px; cursor: pointer;
  display: none; align-items: center; justify-content: center;
  transition: background 0.2s, color 0.2s;
}
#debug-btn.dev-visible { display: flex; }
#debug-btn:hover { background: rgba(0,0,0,0.6); color: white; }
#debug-btn.active { background: rgba(80,40,0,0.7); color: #ffaa44; border-color: rgba(255,160,60,0.5); }

/* ── Dev console overlay ──────────────────────────────────────────────────── */
#dev-console {
  display: none;
  position: absolute; bottom: 0; left: 0; right: 0;
  align-items: center; gap: 8px;
  padding: 8px 12px;
  background: rgba(0, 8, 4, 0.93);
  border-top: 1px solid rgba(0, 210, 90, 0.35);
  font-family: 'SF Mono', 'Fira Code', monospace;
  z-index: 20;
  backdrop-filter: blur(3px);
}
#dev-console.visible {
  display: flex;
  animation: devConsoleFadeIn 0.1s ease-out;
}
@keyframes devConsoleFadeIn {
  from { opacity: 0; transform: translateY(3px); }
  to   { opacity: 1; transform: translateY(0); }
}
.dev-prompt {
  color: #00d060; font-size: 13px; font-weight: bold; flex-shrink: 0;
  text-shadow: 0 0 6px rgba(0,210,90,0.6);
}
#dev-input {
  flex: 1; background: transparent; border: none; outline: none;
  color: #00d060; font-family: inherit; font-size: 13px;
  caret-color: #00d060; letter-spacing: 0.5px;
}
#dev-input::placeholder { color: rgba(0, 200, 80, 0.25); }

/* Arrange (rearrange decorations) button — bottom-right of tank */
#arrange-btn {
  position: absolute; bottom: 8px; right: 8px;
  width: 28px; height: 28px;
  background: rgba(0,0,0,0.35);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  color: rgba(255,255,255,0.45);
  font-size: 13px; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: background 0.2s, color 0.2s, border-color 0.2s;
}
#arrange-btn:hover { background: rgba(0,0,0,0.6); color: white; }
#arrange-btn.active {
  background: rgba(0,40,40,0.75);
  color: #00e8cc;
  border-color: rgba(0,220,190,0.55);
  box-shadow: 0 0 6px rgba(0,220,190,0.25);
}

#debug-panel {
  display: none;
  position: absolute; top: 262px; left: 0; right: 0;
  flex-direction: column; gap: 8px;
  padding: 12px 14px;
  background: rgba(10,21,32,0.88);
  border-top: 1px solid rgba(255,160,60,0.35);
  border-bottom: 1px solid rgba(255,160,60,0.35);
  color: #ffaa44;
  font: bold 11px monospace;
  z-index: 5;
  backdrop-filter: blur(2px);
}
#debug-panel.visible { display: flex; }
#debug-health-row, #debug-rate-row, #debug-accrual-row, #debug-grow-row { display: flex; justify-content: space-between; }
#debug-health-slider, #debug-rate-slider, #debug-accrual-slider, #debug-grow-slider { width: 100%; accent-color: #ffaa44; cursor: ew-resize; }

#debug-coin-btns { display: flex; gap: 4px; flex-wrap: wrap; }
.dbg-coin {
  flex: 1; padding: 3px 0;
  background: rgba(240,200,60,0.1);
  color: #f5c842;
  border: 1px solid rgba(240,200,60,0.3); border-radius: 4px;
  cursor: pointer; font: bold 10px monospace;
  transition: background 0.15s;
}
.dbg-coin:hover { background: rgba(240,200,60,0.25); }
#debug-food-btn {
  flex: 2; padding: 3px 6px;
  background: rgba(180,100,20,0.15);
  color: #e8a855; border: 1px solid rgba(180,100,20,0.35); border-radius: 4px;
  cursor: pointer; font: bold 10px monospace; white-space: nowrap;
  transition: background 0.15s;
}
#debug-food-btn:hover { background: rgba(180,100,20,0.3); }
#debug-fish-btn {
  flex: 2; padding: 3px 6px;
  background: rgba(60,130,200,0.15);
  color: #88bbee; border: 1px solid rgba(60,130,200,0.35); border-radius: 4px;
  cursor: pointer; font: bold 10px monospace; white-space: nowrap;
  transition: background 0.15s;
}
#debug-fish-btn:hover { background: rgba(60,130,200,0.3); }

/* ── Tab bar ──────────────────────────────────────────────────────────────── */
#tab-bar {
  display: flex;
  background: var(--bg-deep);
  border-bottom: 1px solid var(--border);
}
.tab-btn {
  flex: 1; padding: 7px 0;
  background: none; border: none; border-bottom: 2px solid transparent;
  color: var(--text-muted); font-size: 12px; font-weight: 600;
  text-transform: uppercase; letter-spacing: 0.5px;
  cursor: pointer; transition: color 0.15s, border-color 0.15s;
}
.tab-btn:hover { color: var(--text); }
.tab-btn.active { color: var(--accent); border-bottom-color: var(--accent); }

/* ── Shop pane — scrollable ───────────────────────────────────────────────── */
#shop-pane {
  background: var(--bg-panel);
  display: flex;
  flex-direction: column;
}
#shop-pane-head {
  display: flex; align-items: center; gap: 6px;
  padding: 9px 14px 8px;
  border-bottom: 1px solid var(--border);
  flex-shrink: 0;
}
#shop-pane-coins { font-size: 15px; font-weight: 700; color: var(--gold); }
#shop-pane-body {
  overflow-y: auto;
  max-height: 250px;
  padding: 7px 14px 12px;
  display: flex;
  flex-direction: column;
  gap: 6px;
  scrollbar-width: thin;
  scrollbar-color: var(--border) var(--bg-inset);
}
#shop-pane-body::-webkit-scrollbar { width: 5px; }
#shop-pane-body::-webkit-scrollbar-track { background: var(--bg-inset); }
#shop-pane-body::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

#shop-pane-grid, #shop-dec-grid, #shop-bg-grid { display: flex; flex-direction: column; gap: 6px; }

.shop-section-label {
  font-size: 10px; font-weight: 700;
  text-transform: uppercase; letter-spacing: 1px;
  color: var(--text-dim); padding: 4px 0 2px;
}
.spc {
  display: flex; align-items: center; gap: 10px;
  padding: 5px 10px; border-radius: 8px;
  background: var(--bg-inset); border: 1px solid var(--border);
  transition: opacity 0.2s;
}
.spc.unaffordable { opacity: 0.4; }
.spc-canvas, .spc-dec-canvas, .spc-bg-canvas { border-radius: 5px; flex-shrink: 0; }
.spc-info { flex: 1; }
.spc-name { display: block; font-size: 13px; font-weight: 600; }
.spc-desc { display: block; font-size: 11px; color: var(--text-dim); margin-top: 1px; }
.spc-btn, .spc-dec-btn {
  padding: 5px 11px;
  background: #2a1e00; color: var(--gold);
  border: 1px solid #7a5a10; border-radius: 6px;
  cursor: pointer; font-size: 12px; font-weight: 600;
  white-space: nowrap; transition: background 0.15s; flex-shrink: 0;
}
.spc-btn:hover:not(:disabled), .spc-dec-btn:hover:not(:disabled) { background: #3d2e00; }
.spc-btn:disabled, .spc-dec-btn:disabled { opacity: 0.4; cursor: not-allowed; }
.spc-hint { font-size: 11px; color: var(--text-dim); text-align: center; margin-top: 2px; }

.spc-bg-btn {
  padding: 5px 11px;
  background: #2a1e00; color: #f5c842;
  border: 1px solid #7a5a10; border-radius: 6px;
  cursor: pointer; font-size: 12px; font-weight: 600;
  white-space: nowrap; transition: background 0.15s; flex-shrink: 0;
}
.spc-bg-btn:hover:not(:disabled) { background: #3d2e00; }
.spc-bg-btn:disabled { opacity: 0.4; cursor: not-allowed; }
.spc-bg-btn.equip-btn {
  background: #0a1a2a; color: #6aacdc; border-color: #2a5a8a;
}
.spc-bg-btn.equip-btn:hover:not(:disabled) { background: #0f2030; }
.bg-equipped-label {
  padding: 5px 11px;
  background: #0a2a10; color: #6adc8a;
  border: 1px solid #2a6a3a; border-radius: 6px;
  font-size: 12px; font-weight: 600; white-space: nowrap; flex-shrink: 0;
}

/* ── Crew pane ────────────────────────────────────────────────────────────── */
#crew-pane[hidden] { display: none !important; }

#crew-pane {
  background: var(--bg-panel);
  overflow-y: auto;
  max-height: 250px;
  padding: 7px 14px 12px;
  display: flex;
  flex-direction: column;
  gap: 5px;
  scrollbar-width: thin;
  scrollbar-color: var(--border) var(--bg-inset);
}
#crew-pane::-webkit-scrollbar { width: 5px; }
#crew-pane::-webkit-scrollbar-track { background: var(--bg-inset); }
#crew-pane::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }

.crew-section-label {
  font-size: 10px; font-weight: 700;
  text-transform: uppercase; letter-spacing: 1px;
  color: var(--text-dim); padding: 4px 0 2px;
}
.crew-card {
  display: flex; align-items: center; gap: 10px;
  padding: 6px 8px;
  background: var(--bg-inset);
  border: 1px solid var(--border);
  border-radius: 8px;
}
.crew-preview { border-radius: 5px; flex-shrink: 0; }
.crew-info {
  flex: 1; display: flex; flex-direction: column; gap: 3px;
  min-width: 0;
}
.crew-name-row { display: flex; align-items: center; gap: 6px; }
.crew-name {
  font-size: 13px; font-weight: 600;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.crew-badge {
  font-size: 10px; font-weight: 700;
  padding: 1px 6px; border-radius: 4px;
  white-space: nowrap; flex-shrink: 0;
}
.crew-badge[data-state="fry"]      { color: #4dd8aa; background: rgba(0,200,150,0.15); }
.crew-badge[data-state="juvenile"] { color: #6699ff; background: rgba(80,130,255,0.15); }
.crew-badge[data-state="adult"]    { color: #4caf50; background: rgba(76,175,80,0.15); }
.crew-badge[data-state="dead"]     { color: #999;    background: rgba(100,100,100,0.18); }
.crew-badge[data-state="well"]     { color: #4caf50; background: rgba(76,175,80,0.15); }
.crew-badge[data-state="alive"]    { color: #ff9800; background: rgba(255,152,0,0.15); }
.crew-badge[data-state="chest"]    { color: #f5c842; background: rgba(245,200,66,0.12); }
.crew-age { font-size: 11px; color: var(--text-muted); }
.crew-bar-row { display: flex; align-items: center; gap: 6px; }
.crew-bar-wrap {
  flex: 1; height: 4px;
  background: var(--bg-deep); border-radius: 3px; overflow: hidden;
}
.crew-bar { height: 100%; border-radius: 3px; transition: width 0.4s ease; }
.crew-bar-val {
  font-size: 10px; color: var(--text-muted);
  white-space: nowrap; min-width: 56px; text-align: right;
}
.crew-empty {
  font-size: 12px; color: var(--text-dim);
  text-align: center; padding: 20px 0;
}

/* ── Panel ────────────────────────────────────────────────────────────────── */
/* display:flex on #panel and #shop-pane beats the UA [hidden]{display:none},
   so we need to re-enforce it at higher specificity */
#panel[hidden], #shop-pane[hidden] { display: none !important; }

#panel {
  padding: 12px 16px;
  display: flex; flex-direction: column; gap: 8px;
  background: var(--bg-panel);
  position: relative;
}

#score-row { display: flex; align-items: center; gap: 8px; }

#score-bar-wrap {
  flex: 1; height: 7px;
  background: var(--bg-inset); border-radius: 4px; overflow: hidden;
}
#score-bar {
  height: 100%; border-radius: 4px;
  width: 70%; background: #4caf50;
  transition: width 0.6s ease, background 0.6s ease;
}
#score-value { font-size: 15px; font-weight: 700; min-width: 30px; text-align: right; }

#status-row {
  display: flex; align-items: center; gap: 8px;
  background: var(--bg-inset); border-radius: 8px;
  padding: 7px 12px; font-size: 13px; color: var(--text-muted);
}
#status-dot {
  width: 8px; height: 8px; border-radius: 50%;
  background: #555; flex-shrink: 0; transition: background 0.4s;
}
#status-dot.focused    { background: #4caf50; box-shadow: 0 0 6px #4caf5088; }
#status-dot.distracted { background: #f44336; box-shadow: 0 0 6px #f4433688; }
#status-dot.neutral    { background: #ff9800; }

#time-row {
  display: flex; align-items: center;
  background: var(--bg-inset); border-radius: 8px; overflow: hidden;
}
.time-cell {
  flex: 1; display: flex; flex-direction: column;
  align-items: center; padding: 7px 12px;
}
.divider { width: 1px; height: 36px; background: var(--border); }
.label {
  font-size: 11px; text-transform: uppercase;
  letter-spacing: 0.6px; color: var(--text-muted); margin-bottom: 3px;
}
.time-val { font-size: 16px; font-weight: 700; font-variant-numeric: tabular-nums; }
.time-cell.state-focused    { background: rgba(76,175,80,0.13);  border-radius: 8px; }
.time-cell.state-distracted { background: rgba(244,67,54,0.13); border-radius: 8px; }
.time-cell.state-focused    .label { color: #4caf50; }
.time-cell.state-distracted .label { color: #f44336; }
.time-cell.state-focused    .time-val { color: #6dd470; }
.time-cell.state-distracted .time-val { color: #f77; }

/* ── Food row ─────────────────────────────────────────────────────────────── */
#food-row {
  display: flex; align-items: center; gap: 8px;
  background: var(--bg-inset); border-radius: 8px; padding: 6px 12px;
}
.food-icon { font-size: 14px; line-height: 1; flex-shrink: 0; }
.food-lbl  { white-space: nowrap; }
#food-bar-wrap {
  flex: 1; height: 6px;
  background: #162740; border-radius: 4px; overflow: hidden;
}
#food-bar {
  height: 100%; border-radius: 4px;
  width: 100%; background: #4caf50;
  transition: width 0.4s ease, background 0.4s ease;
}
#food-value { font-size: 12px; font-weight: 700; color: var(--text); white-space: nowrap; }
.food-next  { font-size: 10px; color: var(--text-dim); white-space: nowrap; min-width: 42px; text-align: right; }

/* ── Coin row ─────────────────────────────────────────────────────────────── */
#coin-row {
  display: flex; align-items: center; gap: 6px;
  background: var(--bg-inset); border-radius: 8px; padding: 7px 12px;
}
.coin-icon { font-size: 15px; line-height: 1; }
#coin-value { font-size: 16px; font-weight: 700; color: #f5c842; min-width: 32px; }
.coin-label {
  font-size: 11px; text-transform: uppercase;
  letter-spacing: 0.6px; color: #8a6a20; flex: 1;
}
.coin-next  { font-size: 10px; color: var(--text-dim); white-space: nowrap; min-width: 52px; text-align: right; }

/* ── Coin float animation ─────────────────────────────────────────────────── */
.coin-float {
  position: absolute;
  color: #f5c542;
  font-size: 12px;
  font-weight: bold;
  pointer-events: none;
  animation: coinFloat 1.2s ease-out forwards;
}
@keyframes coinFloat {
  0%   { opacity: 1; transform: translateY(0); }
  100% { opacity: 0; transform: translateY(-40px); }
}

#daily-btn {
  padding: 8px; width: 100%;
  background: #1e1400; color: #f5c842;
  border: 1px solid #5a4010; border-radius: 8px;
  cursor: pointer; font-size: 13px; font-weight: 600; letter-spacing: 0.3px;
  transition: background 0.2s, opacity 0.2s;
}
#daily-btn:hover:not(:disabled) { background: #2e1e00; }
#daily-btn:disabled { opacity: 0.45; cursor: not-allowed; }

/* ── Mission banner (absolute overlay on tank canvas) ──────────────────────── */
#mission-banner {
  position: absolute;
  bottom: 12px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(6, 14, 26, 0.76);
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
  border: 1px solid rgba(100, 180, 255, 0.18);
  border-radius: 10px;
  padding: 5px 14px;
  font-size: 11px; color: rgba(210, 230, 255, 0.92);
  text-align: center; line-height: 1.4;
  white-space: nowrap;
  pointer-events: none;
  z-index: 5;
  display: none;
}
#mission-banner.show {
  display: block;
  animation: bannerIn 0.3s ease-out;
}
@keyframes bannerIn {
  from { opacity: 0; transform: translateX(-50%) translateY(4px); }
  to   { opacity: 1; transform: translateX(-50%) translateY(0); }
}

/* ── Away modal ────────────────────────────────────────────────────────────── */
#away-modal {
  display: none;
  position: fixed; inset: 0;
  background: rgba(0,8,16,0.85);
  z-index: 50;
  align-items: center; justify-content: center;
  padding: 20px;
  transition: opacity 0.5s ease;
  cursor: pointer;    /* click backdrop to dismiss early */
}
#away-modal.show   { display: flex; }
#away-modal.fading { opacity: 0; }
#away-card {
  background: var(--bg-panel);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 18px 20px;
  width: 100%;
  display: flex; flex-direction: column; gap: 10px;
  box-shadow: 0 8px 32px rgba(0,0,0,0.55);
  animation: bannerIn 0.25s ease-out;
  cursor: default;    /* don't show pointer over card content */
}
#away-title {
  font-size: 14px; font-weight: 700; color: var(--text);
}
#away-body {
  font-size: 12px; color: var(--text-muted);
  display: flex; flex-direction: column; gap: 5px;
}
#away-body p { line-height: 1.5; }

/* ── Popup toast ───────────────────────────────────────────────────────────── */
#popup-toast {
  position: fixed; bottom: 14px; left: 50%; transform: translateX(-50%);
  background: var(--bg-panel); color: var(--text-muted);
  border: 1px solid var(--border); border-radius: 8px;
  padding: 8px 14px; font-size: 11px; max-width: 300px;
  text-align: center; line-height: 1.4;
  opacity: 0; pointer-events: none;
  transition: opacity 0.25s; z-index: 100;
}
#popup-toast.show { opacity: 1; }
